%{
let getOp op =
    match op with
    | "+" -> ( + )
    | "-" -> ( - )
    | "*" -> ( * )
    | _ -> failwith "unknown operator"
%}

%token <int> Number
%token <string> OP
%token EOF LPAREN RPAREN
%start parse
%type <int> parse
%%

parse: expr EOF        	     { $1 }

expr: Number                 { $1 }
    | expr OP expr           { (getOp $2) $1 $3 }
    | LPAREN expr RPAREN     { $2 }